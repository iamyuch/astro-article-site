---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// 生成页码数组
function generatePageNumbers(current: number, total: number): (number | string)[] {
  const pages: (number | string)[] = [];
  
  if (total <= 7) {
    for (let i = 1; i <= total; i++) {
      pages.push(i);
    }
  } else {
    pages.push(1);
    
    if (current > 3) {
      pages.push('...');
    }
    
    for (let i = Math.max(2, current - 1); i <= Math.min(total - 1, current + 1); i++) {
      pages.push(i);
    }
    
    if (current < total - 2) {
      pages.push('...');
    }
    
    pages.push(total);
  }
  
  return pages;
}

const pageNumbers = generatePageNumbers(currentPage, totalPages);
---

{totalPages > 1 && (
  <div class="mt-8 pt-4 border-t border-gray-300 flex gap-2 text-sm font-sans">
    <span class="font-bold">分页:</span>
    
    {pageNumbers.map(page => (
      typeof page === 'number' ? (
        page === currentPage ? (
          <span class="font-bold text-black border border-black px-2">{page}</span>
        ) : (
          <a href={page === 1 ? baseUrl : `${baseUrl}${page}/`} class="text-link hover:underline hover:bg-gray-100 border border-transparent px-2">
            {page}
          </a>
        )
      ) : (
        <span>{page}</span>
      )
    ))}
    
    {currentPage < totalPages && (
      <a href={`${baseUrl}${currentPage + 1}/`} class="text-link hover:underline hover:bg-gray-100 border border-transparent px-2">
        Next &raquo;
      </a>
    )}
  </div>
)}

<style>
  .text-link {
    color: #0000EE;
  }
  .text-link:visited {
    color: #551A8B;
  }
  .text-link:hover {
    color: #FF0000;
  }
</style>
