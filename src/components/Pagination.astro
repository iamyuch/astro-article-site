---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

// 生成页码数组
function generatePageNumbers(current: number, total: number): (number | string)[] {
  const pages: (number | string)[] = [];
  
  if (total <= 7) {
    for (let i = 1; i <= total; i++) {
      pages.push(i);
    }
  } else {
    pages.push(1);
    
    if (current > 3) {
      pages.push('...');
    }
    
    for (let i = Math.max(2, current - 1); i <= Math.min(total - 1, current + 1); i++) {
      pages.push(i);
    }
    
    if (current < total - 2) {
      pages.push('...');
    }
    
    pages.push(total);
  }
  
  return pages;
}

const pageNumbers = generatePageNumbers(currentPage, totalPages);
---

{totalPages > 1 && (
  <nav class="pagination">
    {currentPage > 1 && (
      <a href={currentPage === 2 ? baseUrl : `${baseUrl}${currentPage - 1}/`} class="page-link prev">
        ← 上一页
      </a>
    )}
    
    <div class="page-numbers">
      {pageNumbers.map(page => (
        typeof page === 'number' ? (
          page === currentPage ? (
            <span class="page-link current">{page}</span>
          ) : (
            <a href={page === 1 ? baseUrl : `${baseUrl}${page}/`} class="page-link">
              {page}
            </a>
          )
        ) : (
          <span class="page-link ellipsis">{page}</span>
        )
      ))}
    </div>
    
    {currentPage < totalPages && (
      <a href={`${baseUrl}${currentPage + 1}/`} class="page-link next">
        下一页 →
      </a>
    )}
  </nav>
)}

<style>
  .pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    gap: 10px;
    margin: 40px 0;
    padding: 20px 0;
    border-top: 1px solid #ddd;
  }
  
  .page-numbers {
    display: flex;
    gap: 5px;
  }
  
  .page-link {
    display: inline-block;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 3px;
    color: #0066cc;
    font-size: 14px;
    transition: all 0.2s;
  }
  
  .page-link:hover {
    background: #f5f5f5;
    text-decoration: none;
  }
  
  .page-link.current {
    background: #0066cc;
    color: #fff;
    border-color: #0066cc;
    cursor: default;
  }
  
  .page-link.ellipsis {
    border: none;
    cursor: default;
    color: #999;
  }
  
  .page-link.ellipsis:hover {
    background: transparent;
  }
  
  .prev, .next {
    font-weight: 500;
  }
  
  @media (max-width: 768px) {
    .pagination {
      flex-wrap: wrap;
    }
    
    .page-link {
      padding: 6px 10px;
      font-size: 13px;
    }
  }
</style>
