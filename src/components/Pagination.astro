---
interface Props {
  currentPage: number;
  totalPages: number;
  baseUrl: string;
}

const { currentPage, totalPages, baseUrl } = Astro.props;

function generatePageNumbers(current: number, total: number): (number | string)[] {
  const pages: (number | string)[] = [];
  
  if (total <= 7) {
    for (let i = 1; i <= total; i++) {
      pages.push(i);
    }
  } else {
    pages.push(1);
    if (current > 3) pages.push('...');
    for (let i = Math.max(2, current - 1); i <= Math.min(total - 1, current + 1); i++) {
      pages.push(i);
    }
    if (current < total - 2) pages.push('...');
    pages.push(total);
  }
  
  return pages;
}

const pageNumbers = generatePageNumbers(currentPage, totalPages);
---

{totalPages > 1 && (
  <div class="pagination">
    <span class="page-label">分页:</span>
    
    {pageNumbers.map(page => (
      typeof page === 'number' ? (
        page === currentPage ? (
          <span class="page-current">{page}</span>
        ) : (
          <a href={page === 1 ? baseUrl : `${baseUrl}${page}/`} class="page-link">
            {page}
          </a>
        )
      ) : (
        <span class="page-ellipsis">{page}</span>
      )
    ))}
    
    {currentPage < totalPages && (
      <a href={`${baseUrl}${currentPage + 1}/`} class="page-link">
        Next &raquo;
      </a>
    )}
  </div>
)}

<style>
  .pagination {
    margin-top: 2rem;
    padding-top: 1rem;
    border-top: 1px solid #d1d5db;
    display: flex;
    gap: 0.5rem;
    font-size: 0.875rem;
    font-family: Verdana, Arial, sans-serif;
  }
  
  .page-label {
    font-weight: bold;
  }
  
  .page-current {
    font-weight: bold;
    color: #000;
    border: 1px solid #000;
    padding: 0 0.5rem;
  }
  
  .page-link {
    color: #0000EE;
    border: 1px solid transparent;
    padding: 0 0.5rem;
  }
  
  .page-link:visited {
    color: #551A8B;
  }
  
  .page-link:hover {
    color: #FF0000;
    text-decoration: underline;
    background: #f5f5f5;
  }
  
  .page-ellipsis {
    color: #666;
  }
</style>
