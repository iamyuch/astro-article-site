---
import { getAllTags } from '../utils/articles';

const tagMap = await getAllTags();
const tags = Array.from(tagMap.entries())
  .map(([name, count]) => ({ name, count }))
  .sort((a, b) => b.count - a.count);
---

<aside class="sidebar">
  <!-- 标签云 -->
  <div>
    <h3 class="sidebar-title">标签</h3>
    <div class="tag-cloud">
      {tags.map(tag => (
        <a href={`/tag/${encodeURIComponent(tag.name)}/`}>
          [#{tag.name}]
        </a>
      ))}
    </div>
  </div>

  <!-- 友情链接 -->
  <div>
    <h3 class="sidebar-title">友情链接</h3>
    <div class="links">
      <p class="empty-text">暂无链接</p>
    </div>
  </div>
</aside>

<!-- 移动端友情链接（放在页面底部） -->
<div class="mobile-links">
  <h3 class="sidebar-title">友情链接</h3>
  <div class="links">
    <p class="empty-text">暂无链接</p>
  </div>
</div>

<style>
  .sidebar {
    display: none;
  }
  
  .sidebar-title {
    font-weight: bold;
    border-bottom: 2px solid #000;
    margin-bottom: 0.75rem;
    padding-bottom: 0.25rem;
    font-size: 0.875rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
  
  .sidebar > div {
    margin-bottom: 2rem;
  }
  
  .tag-cloud {
    display: flex;
    flex-wrap: wrap;
    gap: 0.75rem 0.75rem;
    font-size: 0.875rem;
    line-height: 1.625;
    color: #4b5563;
  }
  
  .tag-cloud a {
    color: #0000EE;
  }
  
  .tag-cloud a:visited {
    color: #551A8B;
  }
  
  .tag-cloud a:hover {
    color: #FF0000;
    text-decoration: underline;
  }
  
  .links {
    font-size: 0.875rem;
    display: flex;
    flex-direction: column;
    gap: 0.25rem;
  }
  
  .empty-text {
    color: #6b7280;
    font-style: italic;
  }
  
  .mobile-links {
    display: block;
    margin-top: 3rem;
    padding-top: 1.5rem;
    border-top: 1px solid #d1d5db;
  }
  
  @media (min-width: 769px) {
    .sidebar {
      display: block;
      border-left: 1px solid #e5e7eb;
      padding-left: 1.5rem;
    }
    
    .mobile-links {
      display: none;
    }
  }
</style>
